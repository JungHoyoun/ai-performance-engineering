"""Baseline BF16 MLP for the Chapter 12 NVFP4 throughput comparison."""

from __future__ import annotations

import sys
from pathlib import Path

repo_root = Path(__file__).parent.parent
if str(repo_root) not in sys.path:
    sys.path.insert(0, str(repo_root))

from core.benchmark.nvfp4_mlp import NVFP4MLPBenchmark, NVFP4MLPConfig
from core.harness.benchmark_harness import BaseBenchmark


def get_benchmark() -> BaseBenchmark:
    config = NVFP4MLPConfig(
        batch_size=512,
        d_model=8192,
        d_ff=32768,
        num_layers=2,
        iterations=20,
        warmup=10,
        name="ch12_nvfp4_mlp",
    )
    return NVFP4MLPBenchmark(config, use_nvfp4=False)
